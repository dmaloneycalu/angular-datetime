/*! angular-datetime Copyright Vokal 2015 */
!function(a,b){"function"==typeof define&&define.amd?define("angular-date-picker",[],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){angular.module("vokal.datePicker",[]).directive("datePicker",["$compile","$filter","$document","$timeout",function(a,b,c,d){"use strict";function e(a){return!!a&&angular.isFunction(a.getTime)&&!isNaN(a.getTime())}function f(a){return e(a)?a:new Date(a)}var g="M/d/yyyy";return{restrict:"A",scope:{},require:"ngModel",link:function(h,i,j,k){function l(a){return"string"===j.pickerType?b("date")(a,j.datePicker||g):a}function m(a){return new Date(a.toDateString()+" "+o.toTimeString())}function n(){c.off("click touchstart",r),h.showDatepicker=!1}var o=new Date((new Date).toDateString());k.$parsers.unshift(function(a){var b=!a;a=f(a);var c=e(a);return k.$setValidity("date",b||c),c&&(o=m(a)),l(o)}),k.$formatters.push(function(a){var c=!a,d=f(a),h=e(d);return k.$setValidity("date",c||h),h&&(o=angular.copy(d)),h?b("date")(d,j.datePicker||g):a}),h.showDatepicker=!1;var p=new Date;h.dayNow=p.getDate(),h.monthNow=p.getMonth()+1,h.yearNow=p.getFullYear(),h.dayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],h.buildMonth=function(a,c){h.days=[],h.filler=[],h.year=a,h.month=c,h.monthName=b("date")(a+"-"+(10>c?"0":"")+c+"-01","MMMM"),h.prevYear=1>c-1?a-1:a,h.nextYear=c+1>12?a+1:a,h.prevMonth=1>c-1?12:c-1,h.nextMonth=c+1>12?1:c+1;for(var d=32-new Date(a,c-1,32).getDate(),e=new Date(a,c-1,1).getDay(),f=1;d>=f;f++)h.days.push(f);for(var g=0;e>g;g++)h.filler.push(g)},h.applyDate=function(a){var c=new Date(a),d=b("date")(c,j.datePicker||g);k.$setViewValue(d),k.$render(),n()};var q=angular.element('<div class="date-picker" data-ng-show="showDatepicker"><div class="month-name">{{ monthName }} {{ year }}</div><div class="month-prev" data-ng-click="buildMonth( prevYear, prevMonth )">&lt;</div><div class="month-next" data-ng-click="buildMonth( nextYear, nextMonth )">&gt;</div><div class="day-name-cell" data-ng-repeat="dayName in dayNames">{{ dayName }}</div><div class="filler-space" data-ng-repeat="space in filler"></div><div class="date-cell" data-ng-class="{ today: dayNow == day && monthNow == month && yearNow == year }" data-ng-repeat="day in days" data-ng-click="applyDate( month + \'/\' + day + \'/\' + year )">{{ day }}</div></div>');a(q)(h),i.after(q),i.on("click",function(){if(!h.showDatepicker){var a,b;if(Date.parse(k.$modelValue)){var e=new Date(k.$modelValue);a=e.getFullYear(),b=e.getMonth()+1}else a=h.yearNow,b=h.monthNow;h.buildMonth(a,b),h.showDatepicker=!0,d(function(){c.on("click touchstart",r)},100)}}),i.on("keydown paste",n),h.$on("$destroy",n);var r=function(a){q[0].contains(a.target)||h.$apply(n)}}}}])});