/*! angular-datetime Copyright Vokal 2015 */
!function(a,b){"function"==typeof define&&define.amd?define("angular-date-picker",[],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){angular.module("vokal.datePicker",[]).directive("datePicker",["$compile","$filter","$document","$timeout",function(a,b,c,d){"use strict";function e(a){return!!a&&moment(new Date(a)).isValid()}var f="M/D/YYYY";return{restrict:"A",scope:{},require:"ngModel",link:function(g,h,i,j){function k(){return"string"===i.pickerType?l(o):o.toDate()}function l(a){return a.format(i.datePicker||f)}function m(a){return moment(new Date(a.toDate().toDateString()+" "+o.toDate().toTimeString()))}function n(){c.off("click touchstart",r),g.showDatepicker=!1}var o=moment();j.$parsers.unshift(function(a){var b=!a,c=e(a);return j.$setValidity("date",b||c),c&&(o=m(moment(new Date(a)))),k()}),j.$formatters.push(function(a){var b=!a,c=e(a);return j.$setValidity("date",b||c),c?(o=moment(new Date(a)),l(o)):a}),g.showDatepicker=!1;var p=new Date;g.dayNow=p.getDate(),g.monthNow=p.getMonth()+1,g.yearNow=p.getFullYear(),g.dayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],g.buildMonth=function(a,c){g.days=[],g.filler=[],g.year=a,g.month=c,g.monthName=b("date")(a+"-"+(10>c?"0":"")+c+"-01","MMMM"),g.prevYear=1>c-1?a-1:a,g.nextYear=c+1>12?a+1:a,g.prevMonth=1>c-1?12:c-1,g.nextMonth=c+1>12?1:c+1;for(var d=32-new Date(a,c-1,32).getDate(),e=new Date(a,c-1,1).getDay(),f=1;d>=f;f++)g.days.push(f);for(var h=0;e>h;h++)g.filler.push(h)},g.applyDate=function(a){var b=l(moment(a,"MM/DD/YYYY"));j.$setViewValue(b),j.$render(),n()};var q=angular.element('<div class="date-picker" data-ng-show="showDatepicker"><div class="month-name">{{ monthName }} {{ year }}</div><div class="month-prev" data-ng-click="buildMonth( prevYear, prevMonth )">&lt;</div><div class="month-next" data-ng-click="buildMonth( nextYear, nextMonth )">&gt;</div><div class="day-name-cell" data-ng-repeat="dayName in dayNames">{{ dayName }}</div><div class="filler-space" data-ng-repeat="space in filler"></div><div class="date-cell" data-ng-class="{ today: dayNow == day && monthNow == month && yearNow == year }" data-ng-repeat="day in days" data-ng-click="applyDate( month + \'/\' + day + \'/\' + year )">{{ day }}</div></div>');a(q)(g),h.after(q),h.on("click",function(){if(!g.showDatepicker){var a,b;if(Date.parse(j.$modelValue)){var e=new Date(j.$modelValue);a=e.getFullYear(),b=e.getMonth()+1}else a=g.yearNow,b=g.monthNow;g.buildMonth(a,b),g.showDatepicker=!0,d(function(){c.on("click touchstart",r)},100)}}),h.on("keydown paste",n),g.$on("$destroy",n);var r=function(a){q[0].contains(a.target)||g.$apply(n)}}}}])});