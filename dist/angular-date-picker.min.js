/*! angular-datetime Copyright Vokal 2016 */
!function(a,b){"function"==typeof define&&define.amd?define("angular-date-picker",[],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){angular.module("vokal.datePicker",[]).directive("datePicker",["$compile","$filter","$document","$timeout",function(a,b,c,d){"use strict";function e(a){return!!a&&moment(new Date(a)).isValid()}var f="M/D/YYYY";return{restrict:"A",scope:{model:"=ngModel",timezone:"="},require:"ngModel",link:function(b,g,h,i){function j(){return"string"===h.pickerType?k(p):p.toDate()}function k(a){return a.format(h.datePicker||f)}function l(a,b,c){p.set({month:a,date:b,year:c})}function m(a){p=moment(a),n()}function n(){h.timezone&&angular.isFunction(p.tz)&&p.tz(b.timezone||moment.tz.guess())}function o(){c.off("click touchstart",s),b.showDatepicker=!1}var p=moment();n(),h.timezone&&!moment.tz&&console.warn("Trying to use timezones without including moment-timezone."),h.timezone&&b.$watch("timezone",function(a,c){a!==c&&(n(),b.model&&(b.model=j()))}),i.$parsers.unshift(function(a){var b=!a,c=e(a);if(i.$setValidity("date",b||c),c){var d=moment(new Date(a));l(d.month(),d.date(),d.years())}return j()}),i.$formatters.push(function(a){var b=!a,c=e(a);return i.$setValidity("date",b||c),c?(m(new Date(a)),k(p)):a});var q=moment();b.showDatepicker=!1,b.dayNow=q.date(),b.monthNow=q.month(),b.yearNow=q.year(),b.dayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],b.buildMonth=function(a,c){var d=moment({year:a,month:c});b.days=[],b.filler=[],b.year=a,b.month=c,b.monthName=d.format("MMMM"),b.prevYear=0>c-1?a-1:a,b.nextYear=c+1>11?a+1:a,b.prevMonth=0>c-1?11:c-1,b.nextMonth=c+1>11?0:c+1;for(var e=d.daysInMonth(),f=d.day(),g=1;e>=g;g++)b.days.push(g);for(var h=0;f>h;h++)b.filler.push(h)},b.applyDate=function(a,c,d){l(a,c,d),b.model=j(),i.$setDirty(),o()};var r=angular.element('<div class="date-picker" data-ng-show="showDatepicker"><div class="month-name">{{ monthName }} {{ year }}</div><div class="month-prev" data-ng-click="buildMonth( prevYear, prevMonth )">&lt;</div><div class="month-next" data-ng-click="buildMonth( nextYear, nextMonth )">&gt;</div><div class="day-name-cell" data-ng-repeat="dayName in dayNames">{{ dayName }}</div><div class="filler-space" data-ng-repeat="space in filler"></div><div class="date-cell" data-ng-class="{ today: dayNow == day && monthNow == month && yearNow == year }" data-ng-repeat="day in days" data-ng-click="applyDate( month, day, year )">{{ day }}</div></div>');a(r)(b),g.after(r),g.on("click",function(){b.showDatepicker||(b.buildMonth(p.year(),p.month()),b.showDatepicker=!0,d(function(){c.on("click touchstart",s)},100))}),g.on("keydown paste",o),b.$on("$destroy",o);var s=function(a){r[0].contains(a.target)||b.$apply(o)}}}}])});