/*! angular-datetime Copyright Vokal 2016 */
!function(a,b){"function"==typeof define&&define.amd?define("angular-date-picker",[],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){angular.module("vokal.datePicker",[]).directive("datePicker",["$compile","$filter","$document","$timeout",function(a,b,c,d){"use strict";function e(a){return!!a&&moment(new Date(a)).isValid()}function f(){g||(console.warn("Trying to use timezones without including moment-timezone."),g=!0)}var g,h="M/D/YYYY";return{restrict:"A",scope:{model:"=ngModel",timezone:"="},require:"ngModel",link:function(b,g,i,j){function k(){return"string"===i.pickerType?l(q):q.toDate()}function l(a){return a.format(i.datePicker||h)}function m(a,b,c){q.set({month:a,date:b,year:c})}function n(a){q=moment(a),o()}function o(){i.timezone&&angular.isFunction(q.tz)&&q.tz(b.timezone||moment.tz.guess())}function p(){c.off("click touchstart",t),b.showDatepicker=!1}var q=moment();o(),i.timezone&&!moment.tz&&f(),i.timezone&&b.$watch("timezone",function(a,c){a!==c&&(o(),b.model&&(b.model=k()))}),j.$parsers.unshift(function(a){var b=!a,c=e(a);if(j.$setValidity("date",b||c),c){var d=moment(new Date(a));m(d.month(),d.date(),d.years())}return k()}),j.$formatters.push(function(a){var b=!a,c=e(a);return j.$setValidity("date",b||c),c?(n(new Date(a)),l(q)):a});var r=moment();b.showDatepicker=!1,b.dayNow=r.date(),b.monthNow=r.month(),b.yearNow=r.year(),b.dayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],b.buildMonth=function(a,c){var d=moment({year:a,month:c});b.days=[],b.filler=[],b.year=a,b.month=c,b.monthName=d.format("MMMM"),b.prevYear=0>c-1?a-1:a,b.nextYear=c+1>11?a+1:a,b.prevMonth=0>c-1?11:c-1,b.nextMonth=c+1>11?0:c+1;for(var e=d.daysInMonth(),f=d.day(),g=1;e>=g;g++)b.days.push(g);for(var h=0;f>h;h++)b.filler.push(h)},b.applyDate=function(a,c,d){m(a,c,d),b.model=k(),j.$setDirty(),p()};var s=angular.element('<div class="date-picker" data-ng-show="showDatepicker"><div class="month-name">{{ monthName }} {{ year }}</div><div class="month-prev" data-ng-click="buildMonth( prevYear, prevMonth )">&lt;</div><div class="month-next" data-ng-click="buildMonth( nextYear, nextMonth )">&gt;</div><div class="day-name-cell" data-ng-repeat="dayName in dayNames">{{ dayName }}</div><div class="filler-space" data-ng-repeat="space in filler"></div><div class="date-cell" data-ng-class="{ today: dayNow == day && monthNow == month && yearNow == year }" data-ng-repeat="day in days" data-ng-click="applyDate( month, day, year )">{{ day }}</div></div>');a(s)(b),g.after(s),g.on("click",function(){b.showDatepicker||(b.buildMonth(q.year(),q.month()),b.showDatepicker=!0,d(function(){c.on("click touchstart",t)},100))}),g.on("keydown paste",p),b.$on("$destroy",p);var t=function(a){s[0].contains(a.target)||b.$apply(p)}}}}])});