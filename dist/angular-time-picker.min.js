/*! angular-datetime Copyright Vokal 2016 */
!function(a,b){"function"==typeof define&&define.amd?define("angular-time-picker",[],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){angular.module("vokal.timePicker",[]).directive("timePicker",["$compile","$filter","$document","$timeout",function(a,b,c,d){"use strict";function e(a){return!!a&&moment(new Date(j+a)).isValid()}function f(a){return!!a&&moment(new Date(a)).isValid()}function g(){h||(console.warn("Trying to use timezones without including moment-timezone."),h=!0)}var h,i="h:mm a",j="1/1/1990 ";return{restrict:"A",scope:{model:"=ngModel",timezone:"="},require:"ngModel",link:function(b,h,k,l){function m(){return"string"===k.pickerType?n(t):t.toDate()}function n(a){return a.format(k.timePicker||i)}function o(a){t=moment(a),q()}function p(a,b){t.set({hour:a,minute:b})}function q(){k.timezone&&angular.isFunction(t.tz)&&t.tz(b.timezone||moment.tz.guess())}function r(){b.showTimepicker||(b.showTimepicker=!0,d(function(){c.on("click touchstart",A)},100))}function s(){c.off("click touchstart",A),b.showTimepicker=!1}var t=moment();q(),k.timezone&&!moment.tz&&g(),k.timezone&&b.$watch("timezone",function(a,c){a!==c&&(q(),b.model&&(b.model=m()))}),l.$parsers.unshift(function(a){var b=!a,c=e(a);if(l.$setValidity("time",b||c),c){var d=moment(new Date(j+a));p(d.hours(),d.minutes())}return m()}),l.$formatters.push(function(a){var b=!a,c=f(a),d=c||e(a);return l.$setValidity("time",b||c||d),d?(o(new Date(c?a:j+a)),n(t)):a}),b.times=[],b.showTimepicker=!1;for(var u,v,w=k.pickerInterval?parseInt(k.pickerInterval,10):60,x=0;24>x;x++)for(var y=0;60>y;y+=w)v=10>y?"0"+y:y,u=new Date(j+x+":"+v),b.times.push({display:n(moment(u)),hours:x,minutes:y});b.applyTime=function(a){p(a.hours,a.minutes),b.model=m(),l.$setDirty(),s()};var z=angular.element('<ol class="time-picker" data-ng-show="showTimepicker"><li data-ng-repeat="time in times" data-ng-click="applyTime( time )">{{ time.display }}</li></ol>');a(z)(b),h.after(z),h.on("click",r),h.on("keydown paste",s),b.$on("$destroy",s);var A=function(a){z[0].contains(a.target)||b.$apply(s)}}}}])});