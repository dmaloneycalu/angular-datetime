/*! angular-datetime Copyright Vokal 2016 */
!function(a,b){"function"==typeof define&&define.amd?define("angular-time-picker",[],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){angular.module("vokal.timePicker",[]).directive("timePicker",["$compile","$filter","$document","$timeout",function(a,b,c,d){"use strict";function e(a){return!!a&&moment(new Date(h+a)).isValid()}function f(a){return!!a&&moment(new Date(a)).isValid()}var g="h:mm a",h="1/1/1990 ";return{restrict:"A",scope:{model:"=ngModel",timezone:"="},require:"ngModel",link:function(b,i,j,k){function l(){return"string"===j.pickerType?m(r):r.toDate()}function m(a){return a.format(j.timePicker||g)}function n(){r=moment(hours),b.timezone&&r.tz(b.timezone)}function o(a,b){r.set({hour:a,minute:b})}function p(){b.showTimepicker||(b.showTimepicker=!0,d(function(){c.on("click touchstart",y)},100))}function q(){c.off("click touchstart",y),b.showTimepicker=!1}b.timezone&&!moment.tz&&console.warn("Trying to use moment-timezone without including the script.");var r=b.timezone?moment.tz():moment();j.timezone&&b.$watch("timezone",function(a,c){a!==c&&(r.tz(a||moment.tz.guess()),b.model=l())}),k.$parsers.unshift(function(a){var b=!a,c=e(a);if(k.$setValidity("time",b||c),c){var d=moment(new Date(h+a));o(d.hours(),d.minutes())}return l()}),k.$formatters.push(function(a){var b=!a,c=f(a),d=c||e(a);return k.$setValidity("time",b||c||d),d?(n(new Date(c?a:h+a)),m(r)):a}),b.times=[],b.showTimepicker=!1;for(var s,t,u=j.pickerInterval?parseInt(j.pickerInterval,10):60,v=0;24>v;v++)for(var w=0;60>w;w+=u)t=10>w?"0"+w:w,s=new Date(h+v+":"+t),b.times.push({display:m(moment(s)),hours:v,minutes:w});b.applyTime=function(a){o(a.hours,a.minutes),b.model=l(),k.$setDirty(),q()};var x=angular.element('<ol class="time-picker" data-ng-show="showTimepicker"><li data-ng-repeat="time in times" data-ng-click="applyTime( time )">{{ time.display }}</li></ol>');a(x)(b),i.after(x),i.on("click",p),i.on("keydown paste",q),b.$on("$destroy",q);var y=function(a){x[0].contains(a.target)||b.$apply(q)}}}}])});