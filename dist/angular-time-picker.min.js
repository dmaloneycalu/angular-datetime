/*! angular-datetime Copyright Vokal 2015 */
angular.module("vokal.timePicker",[]).directive("timePicker",["$compile","$filter",function(a,b){"use strict";return{restrict:"A",scope:{},require:"ngModel",link:function(c,d,e,f){var g="h:mm a",h=function(a){return new Date("1/1/1990 "+a)};f.$parsers.unshift(function(a){var c=h(a);return f.$setValidity("time",!isNaN(c.getTime())),"string"===e.pickerType?b("date")(c,e.timePicker||g):c}),f.$formatters.push(function(a){var c,d=a;return d&&("function"!=typeof d.getTime&&(d=h(d)),c=!isNaN(d.getTime()),f.$setValidity("time",c)),c?b("date")(d,e.timePicker||g):a}),c.times=[],c.showTimepicker=!1;for(var i,j,k,l=e.pickerInterval?parseInt(e.pickerInterval,10):60,m=0;24>m;m++)for(var n=0;60>n;n+=l)j=10>n?"0"+n:n,i=h(m+":"+j),k=b("date")(i,e.timePicker||g),c.times.push(k);c.applyTime=function(a){f.$setViewValue(a),f.$render(),c.showTimepicker=!1};var o=angular.element('<ol class="time-picker" data-ng-show="showTimepicker"><li data-ng-repeat="time in times" data-ng-click="applyTime( time )">{{ time }}</li></ol>');a(o)(c),d.after(o),d.on("click",function(){c.$apply(function(){c.showTimepicker=!0})}),d.on("keydown paste",function(){c.$apply(function(){c.showTimepicker=!1})}),angular.element(document.getElementsByTagName("html")[0]).on("mousedown touchstart",function(a){if(c.showTimepicker){for(var b=angular.element(a.target).scope();b;b=b.$parent)if(c.$id===b.$id)return;c.$apply(function(){c.showTimepicker=!1})}})}}}]);