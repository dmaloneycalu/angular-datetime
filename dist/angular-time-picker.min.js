/*! angular-datetime Copyright Vokal 2015 */
!function(a,b){"function"==typeof define&&define.amd?define("angular-time-picker",[],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){angular.module("vokal.timePicker",[]).directive("timePicker",["$compile","$filter","$document","$timeout",function(a,b,c,d){"use strict";function e(a){return!!a&&moment(new Date(h+a)).isValid()}function f(a){return!!a&&moment(new Date(a)).isValid()}var g="h:mm a",h="1/1/1990 ";return{restrict:"A",scope:{model:"=ngModel",timezone:"="},require:"ngModel",link:function(b,i,j,k){function l(){return"string"===j.pickerType?m(q):q.toDate()}function m(a){return a.format(j.timePicker||g)}function n(a,c){return moment.isDate(a)?(q=moment(a),void(b.timezone&&q.tz(b.timezone))):void q.set({hour:a,minute:c})}function o(){b.showTimepicker||(b.showTimepicker=!0,d(function(){c.on("click touchstart",x)},100))}function p(){c.off("click touchstart",x),b.showTimepicker=!1}b.timezone&&!moment.tz&&console.warn("Trying to use moment-timezone without including the script.");var q=b.timezone?moment.tz():moment();j.timezone&&b.$watch("timezone",function(a,c){a!==c&&(q.tz(a||moment.tz.guess()),b.model=l())}),k.$parsers.unshift(function(a){var b=!a,c=e(a);if(k.$setValidity("time",b||c),c){var d=moment(new Date(h+a));n(d.hours(),d.minutes())}return l()}),k.$formatters.push(function(a){var b=!a,c=f(a),d=c||e(a);return k.$setValidity("time",b||c||d),d?(n(new Date(c?a:h+a)),m(q)):a}),b.times=[],b.showTimepicker=!1;for(var r,s,t=j.pickerInterval?parseInt(j.pickerInterval,10):60,u=0;24>u;u++)for(var v=0;60>v;v+=t)s=10>v?"0"+v:v,r=new Date(h+u+":"+s),b.times.push({display:m(moment(r)),hours:u,minutes:v});b.applyTime=function(a){n(a.hours,a.minutes),b.model=l(),k.$setDirty(),p()};var w=angular.element('<ol class="time-picker" data-ng-show="showTimepicker"><li data-ng-repeat="time in times" data-ng-click="applyTime( time )">{{ time.display }}</li></ol>');a(w)(b),i.after(w),i.on("click",o),i.on("keydown paste",p),b.$on("$destroy",p);var x=function(a){w[0].contains(a.target)||b.$apply(p)}}}}])});