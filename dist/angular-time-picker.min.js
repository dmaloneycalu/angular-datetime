/*! angular-datetime Copyright Vokal 2015 */
!function(a,b){"function"==typeof define&&define.amd?define("angular-time-picker",[],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){angular.module("vokal.timePicker",[]).directive("timePicker",["$compile","$filter","$document","$timeout",function(a,b,c,d){"use strict";function e(a){return!!a&&moment(new Date(h+a)).isValid()}function f(a){return!!a&&moment(new Date(a)).isValid()}var g="h:mm a",h="1/1/1990 ";return{restrict:"A",scope:{},require:"ngModel",link:function(b,i,j,k){function l(){return"string"===j.pickerType?m(q):q.toDate()}function m(a){return a.format(j.timePicker||g)}function n(a){return moment(new Date(q.toDate().toDateString()+" "+a))}function o(){b.showTimepicker||(b.showTimepicker=!0,d(function(){c.on("click touchstart",y)},100))}function p(){c.off("click touchstart",y),b.showTimepicker=!1}var q=moment();k.$parsers.unshift(function(a){var b=!a,c=e(a);return k.$setValidity("time",b||c),c&&(q=n(a)),l()}),k.$formatters.push(function(a){var b=!a,c=f(a),d=c||e(a);return k.$setValidity("time",b||c||d),d?(q=c?moment(new Date(a)):n(a),m(q)):a}),b.times=[],b.showTimepicker=!1;for(var r,s,t,u=j.pickerInterval?parseInt(j.pickerInterval,10):60,v=0;24>v;v++)for(var w=0;60>w;w+=u)s=10>w?"0"+w:w,r=new Date(h+v+":"+s),t=m(moment(r)),b.times.push(t);b.applyTime=function(a){console.log("selectedTime: ",a),k.$setViewValue(a),k.$render(),p()};var x=angular.element('<ol class="time-picker" data-ng-show="showTimepicker"><li data-ng-repeat="time in times" data-ng-click="applyTime( time )">{{ time }}</li></ol>');a(x)(b),i.after(x),i.on("click",o),i.on("keydown paste",p),b.$on("$destroy",p);var y=function(a){x[0].contains(a.target)||b.$apply(p)}}}}])});